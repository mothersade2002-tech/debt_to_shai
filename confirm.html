<!doctype html><html><head><meta charset="utf-8"><title>Confirm Obedience</title><link rel="stylesheet" href="style.css"></head><body>
<main class="centered">
  <div class="big-text">final step</div>
  <div style="width:90%;max-width:720px;margin-top:18px;">
    <p>Type exactly:</p><blockquote>I live to Obey Shai, I will serve until I repay my debt</blockquote>
    <input id="phrase" style="font-size:18px;padding:12px;width:100%">
    <div style="margin-top:12px"><button onclick="finalize()">enter account</button> <a href="index.html" class="link">cancel</a></div>
    <div id="msg" style="margin-top:12px;color:yellow"></div>
  </div>
</main>
<script>
async function finalize(){
  const phrase=document.getElementById('phrase').value.trim();
  const code=sessionStorage.getItem('signin_code');
  const msg=document.getElementById('msg');
  if(!code){ msg.innerText='no session'; return; }
  if(phrase !== 'I live to Obey Shai, I will serve until I repay my debt'){
    msg.innerText='phrase incorrect. $500 penalty applied.';
    await fetch('/.netlify/functions/updateDebt',{method:'POST',headers:{'Content-Type':'application/json'},body: JSON.stringify({ code, newDebtChange:500 })});
    return;
  }
  window.location.href = 'account.html?id='+code;
}
</script>
</body></html>